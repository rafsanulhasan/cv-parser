<div style="margin-bottom: 15px;">
  <label style="display: block; font-weight: bold; margin-bottom: 5px;">{{ label }}</label>
  <div style="display: flex; gap: 10px;">
    <!-- Dropdown Container -->
    <div style="flex: 1; display: flex; align-items: center; border: 1px solid #ccc; border-radius: 4px; background: white;">
      <select 
        [ngModel]="selectedModelId" 
        (ngModelChange)="onModelChange($event)" 
        [disabled]="isDisabled" 
        style="flex: 1; padding: 8px; border: none; background: transparent; outline: none;">
        
        <!-- Grouped (Ollama) -->
        <ng-container *ngIf="isOllamaGrouped; else simpleList">
          <optgroup label="Installed Models (Ready)">
            <option *ngFor="let model of installedModels" [value]="model.id">
              {{ model.name }} <span *ngIf="model.size">({{ model.size }})</span>
            </option>
          </optgroup>
          <optgroup label="Available to Download">
            <option *ngFor="let model of availableToDownloadModels" [value]="model.id">
              {{ model.name }}
            </option>
          </optgroup>
        </ng-container>

        <!-- Simple List (Browser/OpenAI) -->
        <ng-template #simpleList>
          <option *ngFor="let model of models" [value]="model.id">
            {{ model.name }} 
            <span *ngIf="model.size">({{ model.size }})</span> 
            <span *ngIf="model.cached">✅ Cached</span>
          </option>
        </ng-template>

      </select>
      
      <!-- Info Button -->
      <button *ngIf="showInfoButton" 
              (click)="infoClick.emit()" 
              style="padding: 0 8px; background: transparent; border: none; cursor: pointer; font-size: 1.1em; border-left: 1px solid #eee;" 
              title="Model Info">
        ℹ️
      </button>
    </div>

    <!-- Actions (Ollama) -->
    <ng-container *ngIf="showDownload">
      <button *ngIf="!isInstalled && !isPulling" 
              (click)="download.emit()" 
              [disabled]="!selectedModelId"
              [style.opacity]="(!selectedModelId) ? 0.5 : 1"
              style="width: 100px; padding: 8px 0; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; white-space: nowrap; text-align: center; display: flex; justify-content: center; align-items: center;">
          Download
      </button>

      <button *ngIf="isPulling" 
              (click)="cancelPull.emit()" 
              style="width: 100px; padding: 8px 0; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; white-space: nowrap; text-align: center; display: flex; justify-content: center; align-items: center;">
          Cancel
      </button>

      <button *ngIf="showDelete && !isPulling && isInstalled" 
              (click)="delete.emit()" 
              [disabled]="!selectedModelId"
              [style.opacity]="(!selectedModelId) ? 0.5 : 1"
              style="width: 100px; padding: 8px 0; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; white-space: nowrap; text-align: center; display: flex; justify-content: center; align-items: center;">
          {{ deleteConfirming ? 'Confirm?' : 'Delete' }}
      </button>
    </ng-container>
  </div>
</div>
